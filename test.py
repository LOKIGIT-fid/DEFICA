import random
hero = {
    'уровень': 10,
    'здоровье': 150,
    'манна': 80,
    'сила': 15,
    'ловкость': 12,
    'интеллект': 18
}
inventory = ["Зелье исцеления", "Еда"]
visited_rooms = []  # Список для отслеживания посещенных комнат
print('Краткий сюжет: Вы странник, который путешествует по миру.\nОднажды вы натыкаетесь на старинный замок. Вы думаете входить ли внутрь.')
print("\nТвои характеристики:")
for key, value in hero.items():
    print(f"{key.capitalize()}: {value}")
print("\nТвой инвентарь:", inventory)
print('Войти внутрь: \n1. Да \n2. Нет')
Question_1 = str(input())
if Question_1.lower() == "нет":
    print("\nВы испугались войти в замок - игра окончена")
    exit(0)
elif Question_1.lower() == "да":
    print()
else:
    print("Ошибка")
    exit(0)

fdis = True
while fdis == True:
    print("\nВы находитесь в замке. Куда пойти? \n1. Тронный зал \n2. Склад \n3. Оружейная \n4. Подвал \n5. Выйти из игры")
    question = str(input())
    
    if question.lower() == "выйти из игры":
        print("Спасибо за игру! До свидания!")
        break

    if question.lower() in ["тронный зал", "склад", "оружейная", "подвал"]:
        if question.lower() == "тронный зал":
            if question.lower() in visited_rooms:
                print("Вы уже были в этой комнате. Выберите другую.")
                continue
            else:
                visited_rooms.append(question.lower())  # Добавляем комнату в посещенные

            print("Вы входите в тронный зал. Там есть заросший лозами трон, пара столов, камин, а также шкаф.")
            print("В остальном комната не выглядит примечательной. \nОсмотреть шкаф? \n1. Да \n2. Нет")
            scaf = str(input())
            if scaf.lower() == "да":
                print("Вы подходите к шкафу и открываете его. Там есть небольшой мешочек с золотыми монетами. \nВзять его? \n1. Да \n2. Нет")
                meshoc = str(input())
                if meshoc.lower() == "да":
                    print("На мешочке вы обнаружили магическую печать. \nРешите пример для его открытия: \n200 - 105 =")
                    otvet = int(input())
                    if otvet == 95:
                        print("Верно!")
                        inventory.append("Мешочек золота")
                        print("Вы взяли мешочек.")
                        print("Твой инвентарь:", inventory)
                    else:
                        print("Неверно! Игра окончена.")
                        exit(0)
                else:
                    print("Вы решили его не брать.")
        
        elif question.lower() == "склад":
            print("Вы входите на склад, здесь множество ящиков, но, посмотрев в них, вы замечаете, что они в основном пусты.")
            print("Кажется, один ящик запечатан магией.")
            input("Нажмите Enter, чтобы открыть ящик с помощью магии (это потратит 40 единиц манны)...")
            
            if hero['манна'] >= 40:
                hero['манна'] -= 40  # Уменьшаем манну на 40
                print("Вы открываете ящик, потратив 40 единиц манны. Внутри вы находите редкий артефакт!")
                inventory.append("Редкий артефакт (но в бою бесполезен)")
                print("Ваш инвентарь:", inventory)
            else:
                print("У вас недостаточно манны для открытия ящика!")
        
        elif question.lower() == "оружейная":
            while True:  # Позволяем многократный вход в оружейную
                print("Вы входите в оружейную, где множество различных видов оружия.")
                print("На столе вы видите блестящий меч. \nХотите взять меч? \n1. Да \n2. Нет \n3. Выйти из оружейной")
                sword_choice = str(input())
                if sword_choice.lower() == "да":
                    print("На мече вы обнаружили магическую печать. \nРешите пример для его получения: \n50 + 25 =")
                    sword_answer = int(input())
                    if sword_answer == 75:
                        print("Верно!")
                        inventory.append("Блестящий меч")
                        print("Вы взяли меч.")
                        print("Ваш инвентарь:", inventory)
                        break  # Выходим из оружейной после успешного получения меча
                    else:
                        print("Неверно! Игра окончена.")
                        exit(0)
                elif sword_choice.lower() == "нет":
                    print("Вы решили не брать меч.")
                    break  # Выходим из оружейной, не взяв меч
                elif sword_choice.lower() == "выйти из оружейной":
                    print("Вы выходите из оружейной.")
                    break  # Выход из оружейной
                else:
                    print("Ошибка. Пожалуйста, выберите корректный вариант.")

        elif question.lower() == "подвал":
            fidis = True
            while fidis == True:  # Позволяем многократный вход в подвал
                # Проверка на наличие оружия
                if "Блестящий меч" not in inventory:
                    print("У вас нет оружия, чтобы спуститься в подвал. Вам нужно сначала найти оружие!")
                    break  # Выход из подвала, если нет оружия
                print("Вы подходите к двери, ведущей в подвал. Дверь старая и скрипит при открытии.")
                print("Внизу слышен странный звук. Вы хотите спуститься в подвал? \n1. Да \n2. Нет")
                basement_choice = str(input())
                if basement_choice.lower() == "да":
                    print("Вы спускаетесь в подвал. Темнота окружает вас, и вы чувствуете холодный ветер.")
                    print("В подвале вы находите старую книгу и сундук с загадкой.")
                    print("Вы хотите открыть сундук? \n1. Да \n2. Нет")
                    chest_choice = str(input())
                    if chest_choice.lower() == "да":
                        print("Сундук заперт. Чтобы открыть его, решите загадку: \n'Я всегда впереди, но никогда не могу быть пойман. Что я?'")
                        riddle_answer = str(input())
                        if riddle_answer.lower() == "будущее":
                            print("Верно! Сундук открыт. Вы нашли драгоценности!")
                            inventory.append("Драгоценности")
                            print("Ваш инвентарь:", inventory)
                            # После открытия сундука игрок остаётся в подвале и переходит к битве с монстром
                            fdis = False
                            fidis = False
                        else:
                            print("Неверно! Сундук остается закрытым.")
                    else:
                        print("Вы решили не открывать сундук.")
                    continue  # Продолжаем цикл, чтобы игрок мог исследовать подвал дальше
    else:
        print("Ошибка. Пожалуйста, выберите корректный вариант.")

# Начало боя с монстром
print("Вы идете дальше по подвалу и внезапно слышите рык за спиной.")
input()
print("Вы оборачиваетесь и видите монстра, похожего на огромную черную собаку!")
# Здоровье монстра
monster_health = 100
while hero['здоровье'] > 0 and monster_health > 0:
    print(f"\nВаше здоровье: {hero['здоровье']}, Здоровье монстра: {monster_health}")
    print("Выберите, куда атаковать монстра: \n1. Голова \n2. Тело \n3. Лапы")
    attack_choice = str(input())

    # Определяем урон и шанс попадания
    if attack_choice == "1":
        damage = random.randint(20, 30)  # Урон при атаке в голову
        hit_chance = random.randint(1, 100)
        if hit_chance <= 70:  # 70% шанс попадания
            print(f"Вы ударили монстра в голову и нанесли {damage} урона!")
            monster_health -= damage
        else:
            print("Ваш удар промахнулся!")
    
    elif attack_choice == "2":
        damage = random.randint(10, 20)  # Урон при атаке в тело
        hit_chance = random.randint(1, 100)
        if hit_chance <= 80:  # 80% шанс попадания
            print(f"Вы ударили монстра в тело и нанесли {damage} урона!")
            monster_health -= damage
        else:
            print("Ваш удар промахнулся!")

    elif attack_choice == "3":
        damage = random.randint(5, 15)  # Урон при атаке в лапы
        hit_chance = random.randint(1, 100)
        if hit_chance <= 90:  # 90% шанс попадания
            print(f"Вы ударили монстра в лапы и нанесли {damage} урона!")
            monster_health -= damage
        else:
            print("Ваш удар промахнулся!")
    else:
        print("Ошибка. Пожалуйста, выберите корректный вариант.")
    # Монстр атакует
    if monster_health > 0:
        monster_damage = random.randint(10, 25)  # Урон монстра
        print(f"Монстр атакует вас и наносит {monster_damage} урона!")
        hero['здоровье'] -= monster_damage

# Проверка на окончание боя
if hero['здоровье'] <= 0:
    print("Вы погибли в бою! Игра окончена.")
    exit(0)
else:
    print("Вы победили монстра! Поздравляем!")
    input()
    print("Победив монстра, вы продвигаетесь дальше по подвалу и находите дверь с печатью.")
    input()
    print("На этой двери уже знакомая печать, но она куда сложнее.")
    input()
    print("На двери написано: 'Чтобы открыть эту дверь, реши загадку, основанную на числах.'")
    input()
    # Загадка для открытия двери
    print("Загадка:")
    print("Я — число, которое больше 10 и меньше 20. Если вы умножите меня на 2, а затем вычтете 5, вы получите 15.")
    print("Какое это число?(одна часть загадки врет(одно число))")
    # Получаем ответ от игрока
    door_answer = int(input("Введите ваш ответ: "))
    # Проверяем ответ
    if door_answer == 10:
        print("Правильный ответ! Дверь начинает светиться, и вы слышите треск, когда она открывается.")
        print("Вы входите в следующую комнату, полную древних артефактов и сокровищ.")
        print("Поздравляем! Вы завершили свою приключенческую историю!")
    else:
        print("Неверный ответ! Дверь остается закрытой. А печать потухла. Вы расстроились и пошли назад. Игра окончена.")
        exit(0)